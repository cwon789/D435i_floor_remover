floor_remover_node:
  ros__parameters:
    # ====================
    # Topic Configuration
    # ====================
    input_cloud_topic: "/camera/depth/color/points"
    input_imu_topic: "/camera/imu"
    output_cloud_topic: "/floor_removed_cloud"
    floor_cloud_topic: "/floor_cloud"
    gravity_marker_topic: "/gravity_vector"

    # ========================================
    # Point Cloud Preprocessing
    # ========================================

    # Distance Filtering
    # D435i effective range: 0.3m - 10m (indoor recommended: 0.3 - 5.0m)
    min_distance: 0.1  # meters
    max_distance: 3.0  # meters

    # Voxel Downsampling
    # Smaller values: higher detail, slower processing
    # Recommended range: 0.005 - 0.02m
    voxel_leaf_size: 0.005  # meters

    # ========================================
    # Floor Plane Detection (RANSAC)
    # ========================================

    # Plane inlier distance threshold
    # Points within this distance from the plane are considered inliers
    plane_distance_threshold: 0.015  # meters (1.5cm tolerance)

    # RANSAC maximum iterations
    # Higher values: more accurate but slower
    plane_max_iterations: 300

    # ========================================
    # IMU-Based Floor Validation
    # ========================================

    # Enable IMU-based floor validation
    # true: Validate floor using IMU gravity vector (physically accurate)
    # false: Use fixed vector [0, -1, 0]
    use_imu_for_validation: true

    # IMU sample buffer size (for gravity direction estimation)
    imu_buffer_size: 50

    # Gravity vector low-pass filter alpha value
    # alpha = new value reflection ratio (0.0 - 1.0)
    # Higher values: faster response, more noise
    # Lower values: slower response, more stable
    # Recommended: 0.2 - 0.4
    gravity_filter_alpha: 0.3

    # Floor normal alignment threshold (compared with IMU gravity vector or fixed vector)
    # Value = cos(θ), where θ is the angle between vectors
    #
    # Examples:
    #   1.0  = 0°   (perfect horizontal floor)
    #   0.87 = 30°  (allows floors tilted up to 30 degrees)
    #   0.7  = 45°  (allows up to 45 degrees)
    #   0.5  = 60°  (allows up to 60 degrees)
    #
    # Recommended: 0.85-0.90 (stable floor detection)
    floor_normal_alignment_threshold: 0.95

    # ========================================
    # Floor Removal Settings
    # ========================================

    # Maximum height from floor (above this is removed as ceiling/noise)
    max_height_threshold: 2.0  # meters

    # Additional upward removal margin from detected floor plane
    # Points within this distance above the floor will also be removed
    # Useful for removing small objects or noise just above the floor
    # Example: 0.05 = remove points up to 5cm above the detected floor
    # Recommended range: 0.0 - 0.1m
    additional_removal_margin: 0.0  # meters (0 = disabled)

    # ========================================
    # Depth Image Projection (Optional)
    # ========================================

    # Enable depth image projection from pointcloud
    # Warning: This feature is resource-intensive and may impact performance
    # Set to false to disable depth image publishing and save computational resources
    depth_image_projection: true

    # Number of interpolation iterations to fill holes in projected depth image
    # Higher values: more holes filled, but may introduce artifacts
    # Recommended range: 1-5
    depth_interpolation_iterations: 3

    # Minimum number of valid neighbors required for interpolation
    # Used in 3x3 kernel neighborhood interpolation
    # Higher values: more conservative (fewer artifacts, more holes remain)
    # Lower values: more aggressive (fewer holes, possible artifacts)
    # Range: 1-8 (max neighbors in 3x3 kernel)
    min_neighbors_for_interpolation: 2
